# toydb-go

https://cstack.github.io/db_tutorial/

## 学びたいこと

- データがどのように保存されているか。B-treeを実際に実装してみて、インデックスがどのように使われるのかをイメージできるようになりたい。
- SQLの構文解析の実装を知りたい。ORMを作るときに、クエリとスキーマから入出力の型を生成する処理を書きたいため（sqlcみたいなイメージ）。構文解析はほとんど実装したことがない。

## データベースについて知っていること

- SQLはデータをどのように取得するかではなく、何を取得したいかを記述する。データの具体的な取得方法はDBMSのオプティマイザが決める。
- その性質上、SQLを高速する方法で最も一般的なのはインデックスを付与すること。
- インデックスはソート済みの列（インデックスを付与した列）を別で持っているイメージをしている。そのため、検索（WHERE）は二分探索によって、ソート（ORDER BY）は順番に取り出すことによって高速化できる。
- SQLは集合論や述語論理などの数学の理論を基礎にしている。
- リレーショナルモデルのリレーションとは、タプルの集合のこと。リレーションとは、実装の言葉で言うとテーブルのこと。
- データの更新を正しく行うために、ロックやトランザクションなどの機構がある。アルゴリズムや実装は調べたことがない。
- 従来のRDBMSは、書き込みを直列に行うようになっている（気がする）。読み込みの負荷はデータをコピーしたレプリカを作ることで分散することができるが、書き込みはできない。そのため、書き込みが多いサービスでは（ちょっと前は）NoSQLを使っていた。

## Chapter 1

SQLが実行されるまで、

トークナイザー→パーサー→コードジェネレーター→

バーチャルマシン→B-tree→pager→OS interface

のようにたどっていく。SQLはSQLite用のバイトコードに変換され、バーチャルマシンで実行される。前半のコンポーネントをフロントエンド、後半をバックエンドという。

とりあえず入力を受け取れるようにする。fmt.Scanlnに文字列のポインタではなく文字列を渡すと、入力を読み取る前に次に進んでしまった。

構造体のポインタを持っている時、ドットアクセスする時は*を省略できるんでしたっけ。
